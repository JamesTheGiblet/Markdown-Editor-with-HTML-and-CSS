<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown Editor & Previewer</title>
    <style>
        /* Global & Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 50%, #16213e 100%);
            color: #ffffff;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Animated Background */
        #bg-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.3;
        }

        /* Navigation */
        nav {
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            -webkit-backdrop-filter: blur(20px);
            backdrop-filter: blur(20px);
            background: rgba(12, 12, 12, 0.8);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .nav-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #00d4ff, #ff00ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-decoration: none;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        .nav-links a {
            color: #ffffff;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-links a:hover {
            color: #00d4ff;
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(135deg, #00d4ff, #ff00ff);
            transition: width 0.3s ease;
        }

        .nav-links a:hover::after {
            width: 100%;
        }

        /* Page Header */
        .page-header {
            padding-top: 150px;
            padding-bottom: 60px;
            text-align: center;
            position: relative;
        }

        .page-header h1 {
            font-size: clamp(2.5rem, 6vw, 4rem);
            font-weight: 900;
            line-height: 1.1;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #ffffff, #00d4ff, #ff00ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from {
                filter: drop-shadow(0 0 20px rgba(0, 212, 255, 0.3));
            }
            to {
                filter: drop-shadow(0 0 40px rgba(255, 0, 255, 0.5));
            }
        }

        .page-header p {
            font-size: 1.2rem;
            line-height: 1.6;
            color: rgba(255, 255, 255, 0.8);
            max-width: 700px;
            margin: 0 auto;
        }

        /* Editor Layout */
        .editor-container {
            display: flex;
            flex-direction: column;
            gap: 2rem;
            margin-bottom: 4rem;
        }

        @media (min-width: 992px) {
            .editor-container {
                flex-direction: row;
            }
        }

        .editor-panel, .preview-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: rgba(15, 23, 42, 0.7);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 16px;
            padding: 1.5rem;
            -webkit-backdrop-filter: blur(20px);
            backdrop-filter: blur(20px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .panel-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #ffffff;
        }

        .editor-toolbar {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .tool-btn {
            background: rgba(12, 12, 12, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            color: #ffffff;
            padding: 0.5rem 0.75rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .tool-btn:hover {
            background: rgba(0, 212, 255, 0.2);
            border-color: rgba(0, 212, 255, 0.5);
        }

        #markdown-input {
            width: 100%;
            flex-grow: 1;
            min-height: 400px;
            background: rgba(12, 12, 12, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: #ffffff;
            padding: 1rem;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.95rem;
            line-height: 1.5;
            resize: vertical;
            transition: border-color 0.3s ease;
        }

        #markdown-input:focus {
            outline: none;
            border-color: #00d4ff;
            box-shadow: 0 0 15px rgba(0, 212, 255, 0.3);
        }

        #markdown-preview {
            flex-grow: 1;
            overflow-y: auto;
            padding: 1rem;
            background: rgba(12, 12, 12, 0.3);
            border-radius: 8px;
            min-height: 400px;
        }

        /* Markdown Content Styling */
        #markdown-preview h1,
        #markdown-preview h2,
        #markdown-preview h3 {
            font-weight: 700;
            color: #ffffff;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        #markdown-preview h1 { font-size: 2rem; }
        #markdown-preview h2 { font-size: 1.75rem; }
        #markdown-preview h3 { font-size: 1.5rem; }

        #markdown-preview p {
            margin-bottom: 1rem;
            line-height: 1.6;
        }

        #markdown-preview a {
            color: #00d4ff;
            text-decoration: none;
            font-weight: 500;
        }

        #markdown-preview a:hover {
            text-decoration: underline;
        }

        #markdown-preview ul,
        #markdown-preview ol {
            margin-left: 1.5rem;
            margin-bottom: 1rem;
        }

        #markdown-preview code {
            background: rgba(0, 0, 0, 0.3);
            padding: 0.2em 0.4em;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.9em;
            color: #f1fa8c;
        }

        #markdown-preview pre {
            background: rgba(0, 0, 0, 0.5);
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            margin-bottom: 1rem;
        }

        #markdown-preview pre code {
            background: transparent;
            padding: 0;
            color: inherit;
        }

        #markdown-preview blockquote {
            border-left: 4px solid rgba(0, 212, 255, 0.5);
            padding-left: 1rem;
            margin-left: 0;
            margin-bottom: 1rem;
            color: rgba(255, 255, 255, 0.7);
        }

        #markdown-preview table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1rem;
        }

        #markdown-preview th, #markdown-preview td {
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 0.5rem;
        }

        #markdown-preview th {
            background: rgba(0, 0, 0, 0.3);
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
            margin-bottom: 4rem;
        }

        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 50px;
            font-weight: 600;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        .btn-primary {
            background: linear-gradient(135deg, #00d4ff, #ff00ff);
            color: white;
            box-shadow: 0 10px 30px rgba(0, 212, 255, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 20px 40px rgba(0, 212, 255, 0.5);
        }

        .btn-secondary {
            background: transparent;
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            -webkit-backdrop-filter: blur(10px);
            backdrop-filter: blur(10px);
        }

        .btn-secondary:hover {
            border-color: #00d4ff;
            color: #00d4ff;
            transform: translateY(-3px);
        }

        .btn-danger {
            background: transparent;
            color: #ff5555;
            border: 2px solid rgba(255, 85, 85, 0.5);
        }

        .btn-danger:hover {
            border-color: #ff5555;
            color: white;
            background: rgba(255, 85, 85, 0.2);
            transform: translateY(-3px);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }

            .page-header {
                padding-top: 120px;
                padding-bottom: 40px;
            }

            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav>
        <div class="container">
            <div class="nav-content">
                <a href="#" class="logo">Markdown Editor</a>
                <ul class="nav-links">
                    <li><a href="#">Home</a></li>
                    <li><a href="#">Features</a></li>
                    <li><a href="#">Docs</a></li>
                    <li><a href="#">Contact</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Page Header -->
    <section class="page-header">
        <div class="container">
            <h1>Markdown Editor & Previewer</h1>
            <p>Create, edit, and preview your markdown content in real-time with our powerful editor</p>
        </div>
    </section>

    <!-- Editor Section -->
    <section class="container editor-container">
        <!-- Editor Panel -->
        <div class="editor-panel">
            <div class="panel-header">
                <h3 class="panel-title">Editor</h3>
                <div class="editor-toolbar">
                    <button class="tool-btn" data-tag="**" data-sample="bold text">B</button>
                    <button class="tool-btn" data-tag="*" data-sample="italic text">I</button>
                    <button class="tool-btn" data-tag="# " data-sample="Heading">H1</button>
                    <button class="tool-btn" data-tag="## " data-sample="Subheading">H2</button>
                    <button class="tool-btn" data-tag="> " data-sample="Blockquote">Q</button>
                    <button class="tool-btn" data-tag="```\ncode\n```" data-sample="code block">Code</button>
                    <button class="tool-btn" data-tag="- " data-sample="list item">List</button>
                    <button class="tool-btn" data-tag="[text](url)" data-sample="link">Link</button>
                </div>
            </div>
            <textarea id="markdown-input" placeholder="Start writing your markdown here..."># Welcome to Markdown Editor

## This is a subheading

Here's some **bold** and *italic* text.

### Features:
- Real-time preview
- Easy formatting tools
- Clean interface

### Code Example:
```javascript
function helloWorld() {
    console.log('Hello, Markdown Editor!');
}
```</textarea>
        </div>
        <!-- Preview Panel -->
        <div class="preview-panel">
            <div class="panel-header">
                <h3 class="panel-title">Preview</h3>
            </div>
            <div id="markdown-preview"></div>
        </div>
    </section>

    <!-- Action Buttons -->
    <div class="container">
        <div class="action-buttons">
            <button id="copy-btn" class="btn btn-secondary">Copy Markdown</button>
            <button id="clear-btn" class="btn btn-danger">Clear Editor</button>
            <button id="download-btn" class="btn btn-primary">Download as HTML</button>
        </div>
    </div>

    <canvas id="bg-canvas"></canvas>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify/dist/purify.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- DOM Elements ---
            const markdownInput = document.getElementById('markdown-input');
            const markdownPreview = document.getElementById('markdown-preview');
            const toolBtns = document.querySelectorAll('.tool-btn');
            const copyBtn = document.getElementById('copy-btn');
            const downloadBtn = document.getElementById('download-btn');
            const clearBtn = document.getElementById('clear-btn');
            const canvas = document.getElementById('bg-canvas');

            // --- Marked.js Configuration for Syntax Highlighting ---
            marked.setOptions({
                highlight: function(code, lang) {
                    const language = hljs.getLanguage(lang) ? lang : 'plaintext';
                    return hljs.highlight(code, { language }).value;
                },
                langPrefix: 'hljs language-', // for CSS classes
                breaks: true, // render <br> on single line breaks
            });

            // --- Core Functions ---
            function updatePreview() {
                const rawMarkdown = markdownInput.value;
                const dirtyHtml = marked.parse(rawMarkdown);
                const cleanHtml = DOMPurify.sanitize(dirtyHtml);
                markdownPreview.innerHTML = cleanHtml;
                localStorage.setItem('markdownContent', rawMarkdown);
                // Re-run highlighter on the preview pane
                document.querySelectorAll('#markdown-preview pre code').forEach((block) => {
                    hljs.highlightElement(block);
                });
            }

            function applyMarkdown(tag, sample) {
                const start = markdownInput.selectionStart;
                const end = markdownInput.selectionEnd;
                const selectedText = markdownInput.value.substring(start, end);

                if (['# ', '## ', '> ', '- '].includes(tag)) {
                    const textBeforeCursor = markdownInput.value.substring(0, start);
                    const lineStart = textBeforeCursor.lastIndexOf('\n') + 1;
                    markdownInput.setRangeText(tag, lineStart, lineStart);
                    markdownInput.setSelectionRange(start + tag.length, end + tag.length);
                } else if (['**', '*'].includes(tag)) {
                    const suffix = tag;
                    if (!selectedText) {
                        markdownInput.setRangeText(`${tag}${sample}${suffix}`, start, end);
                        markdownInput.setSelectionRange(start + tag.length, start + tag.length + sample.length);
                    } else {
                        markdownInput.setRangeText(`${tag}${selectedText}${suffix}`, start, end);
                        markdownInput.setSelectionRange(end + tag.length + suffix.length, end + tag.length + suffix.length);
                    }
                } else if (tag === '```\ncode\n```') {
                    const lang = 'javascript';
                    const placeholder = 'console.log("Hello, world!");';
                    const textToInsert = `\`\`\`${lang}\n${selectedText || placeholder}\n\`\`\``;
                    markdownInput.setRangeText(textToInsert, start, end);
                    const selectStart = start + `\`\`\`${lang}\n`.length;
                    const selectEnd = selectStart + (selectedText || placeholder).length;
                    markdownInput.setSelectionRange(selectStart, selectEnd);
                } else if (tag === 'text') {
                    const linkText = selectedText || 'link text';
                    const textToInsert = `${linkText}`;
                    markdownInput.setRangeText(textToInsert, start, end);
                    // Intelligently select 'url' for easy replacement by the user
                    const urlStart = start + `${linkText};
                }

                markdownInput.focus();
                updatePreview();
            }

            // --- Initial Setup ---
            const savedMarkdown = localStorage.getItem('markdownContent');
            if (savedMarkdown) {
                markdownInput.value = savedMarkdown;
            }
            updatePreview();

            // --- Event Listeners ---
            markdownInput.addEventListener('input', updatePreview);
            toolBtns.forEach(btn => btn.addEventListener('click', () => applyMarkdown(btn.dataset.tag, btn.dataset.sample)));
            copyBtn.addEventListener('click', () => {
                navigator.clipboard.writeText(markdownInput.value).then(() => {
                    const originalText = copyBtn.innerText;
                    copyBtn.innerText = 'Copied!';
                    setTimeout(() => { copyBtn.innerText = originalText; }, 2000);
                }).catch(err => console.error('Failed to copy text: ', err));
            });
            downloadBtn.addEventListener('click', () => {
                const htmlContent = markdownPreview.innerHTML;
                const fullHtml = `<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Markdown Export</title><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css"><style>body{font-family:sans-serif;line-height:1.6;padding:2rem;max-width:800px;margin:auto;}pre{border-radius:5px;}img{max-width:100%;}</style></head><body>${htmlContent}</body></html>`;
                const blob = new Blob([fullHtml], { type: 'text/html' });
                const a = document.createElement('a');
                a.href = URL.createObjectURL(blob);
                a.download = 'markdown-export.html';
                a.click();
                URL.revokeObjectURL(a.href);
            });

            clearBtn.addEventListener('click', () => {
                if (confirm('Are you sure you want to clear the editor? This action cannot be undone.')) {
                    markdownInput.value = '';
                    updatePreview(); // This also clears localStorage and the preview pane
                }
            });

            // --- Animated Background ---
            if (canvas) {
                const ctx = canvas.getContext('2d');
                let width = canvas.width = window.innerWidth;
                let height = canvas.height = window.innerHeight;
                let particles = [];
                window.addEventListener('resize', () => {
                    width = canvas.width = window.innerWidth;
                    height = canvas.height = window.innerHeight;
                    createParticles();
                });
                class Particle {
                    constructor() { this.x = Math.random() * width; this.y = Math.random() * height; this.vx = -1 + Math.random() * 2; this.vy = -1 + Math.random() * 2; this.radius = Math.random() * 2; }
                    update() { this.x += this.vx; this.y += this.vy; if (this.x < 0 || this.x > width) this.vx *= -1; if (this.y < 0 || this.y > height) this.vy *= -1; }
                    draw() { ctx.beginPath(); ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2); ctx.fillStyle = 'rgba(255, 255, 255, 0.5)'; ctx.fill(); }
                }
                function createParticles() {
                    particles = [];
                    const particleCount = Math.floor(width * height / 15000);
                    for (let i = 0; i < particleCount; i++) { particles.push(new Particle()); }
                }
                function animate() { ctx.clearRect(0, 0, width, height); particles.forEach(p => { p.update(); p.draw(); }); requestAnimationFrame(animate); }
                createParticles();
                animate();
            }
        });
    </script>
</body>
</html>
